@using Hisar.Component.FileManager.Controllers

<div class="input-append">
    <input id="fm-bs-modal-input" type="text" value="">
    <a data-toggle="modal" data-target="#fm-bs-modal" class="btn" type="button">Select</a>
</div>

<div id="fm-bs-modal" class="modal fade">
    <div class="modal-dialog" style="width: 1000px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Modal title</h4>
            </div>
            <div class="modal-body" style="width: 100%; height: 600px">
                <iframe width="100%" height="100%" src="" frameborder="0"></iframe>
            </div>
        </div>
    </div>
</div>

<script>
    /*---------------------------------------------------------
     Bootstrap 3 modal window with iframe example
     ---------------------------------------------------------*/
//            $('#fm-bs-modal').on('show.bs.modal', function() {
//                $(this).find('iframe').attr('src', './../index.html?context=bootstrap');
//            });

    $('#fm-bs-modal').on('show.bs.modal', function () {
        var fileManagerUrl = '@Url.Action("Index", "Home")';
        $(this).find('iframe').attr('src', fileManagerUrl);

        function handlePostMessage(e) {
            var data = e.originalEvent.data;
            if (data.source === 'richfilemanager') {
                $('#fm-bs-modal-input').val(data.preview_url);
                $('#fm-bs-modal').find('.close').click();

                // remove an event handler
                $(window).off('message', handlePostMessage);
            }
        }

        $(window).on('message', handlePostMessage);
    });

</script>